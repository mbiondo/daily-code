---
import { and, db, eq, ExerciseResponse, Exercise, MultilingualText } from "astro:db"

const exercise = await db
	.select()
	.from(Exercise)
	.innerJoin(MultilingualText, eq(Exercise.id, MultilingualText.exerciseId))
	.where(eq(MultilingualText.language, "pt"))
	.get()

const responses = await db
	.select()
	.from(ExerciseResponse)
	.innerJoin(MultilingualText, eq(ExerciseResponse.id, MultilingualText.responseId))
	.where(and(eq(ExerciseResponse.exerciseId, 1), eq(MultilingualText.language, "pt")))
---

<html lang='en'>
	<head>
		<meta charset='utf-8' />
		<link rel='icon' type='image/svg+xml' href='/favicon.svg' />
		<meta name='viewport' content='width=device-width' />
		<meta name='generator' content={Astro.generator} />
		<title>Astro</title>
	</head>
	<body>
		<h1>Astro</h1>
		<p>{exercise?.MultilingualText.text}</p>
		<pre>
			<code>
				{exercise?.Exercise.code}
			</code>
		</pre>
		<form action='/submit' method='post'>
			<ul>
				{
					responses.map((response) => (
						<li>
							<label>
								<input type='radio' name='response' value={response.MultilingualText.text} />
								{response.MultilingualText.text}
							</label>
						</li>
					))
				}
			</ul>
			<button type='submit'>Submit</button>
		</form>
	</body>
</html>
